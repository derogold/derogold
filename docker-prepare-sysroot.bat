@echo off

docker run --rm --platform linux/amd64 -v %~dp0docker\sysroot:/usr/local/src/sysroot ubuntu:20.04 sh -c "apt-get update && apt-get install -y symlinks libc6-dev libgcc-9-dev libstdc++-9-dev && symlinks -cr /usr/lib && tar -cvzf /usr/local/src/sysroot/ubuntu-20.04-x86_64-linux-gnu-sysroot.tar.gz /usr/lib/x86_64-linux-gnu/ /usr/lib/gcc/ /usr/include/ && mkdir /usr/local/sysroot && tar -xzvf /usr/local/src/sysroot/ubuntu-20.04-x86_64-linux-gnu-sysroot.tar.gz -C /usr/local/sysroot && cd /usr/local/sysroot && ln -s usr/include include && ln -s usr/lib lib && tar -cvzf /usr/local/src/sysroot/ubuntu-20.04-x86_64-linux-gnu-sysroot.tar.gz usr include lib"
docker run --rm --platform linux/arm64 -v %~dp0docker\sysroot:/usr/local/src/sysroot ubuntu:20.04 sh -c "apt-get update && apt-get install -y symlinks libc6-dev libgcc-9-dev libstdc++-9-dev && symlinks -cr /usr/lib && tar -cvzf /usr/local/src/sysroot/ubuntu-20.04-aarch64-linux-gnu-sysroot.tar.gz /usr/lib/aarch64-linux-gnu/ /usr/lib/gcc/ /usr/include/ && mkdir /usr/local/sysroot && tar -xzvf /usr/local/src/sysroot/ubuntu-20.04-aarch64-linux-gnu-sysroot.tar.gz -C /usr/local/sysroot && cd /usr/local/sysroot && ln -s usr/include include && ln -s usr/lib lib && tar -cvzf /usr/local/src/sysroot/ubuntu-20.04-aarch64-linux-gnu-sysroot.tar.gz usr include lib"
